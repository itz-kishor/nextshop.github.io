{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport Head from 'next/head';\nimport { useContext, useState } from 'react';\nimport { DataContext } from '../store/GlobalState';\nimport { updateItem } from '../store/Actions';\nimport { postData, putData } from \"../utils/fetchData\";\n\nvar Categories = function Categories() {\n  var _useState = useState(''),\n      name = _useState[0],\n      setName = _useState[1];\n\n  var _useContext = useContext(DataContext),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var categories = state.categories,\n      auth = state.auth;\n\n  var _useState2 = useState(''),\n      id = _useState2[0],\n      setId = _useState2[1];\n\n  var createCategory = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(auth.user.role !== 'admin')) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\", dispatch({\n                type: 'NOTIFY',\n                payload: {\n                  error: 'Authentication is not vaild.'\n                }\n              }));\n\n            case 2:\n              if (name) {\n                _context.next = 4;\n                break;\n              }\n\n              return _context.abrupt(\"return\", dispatch({\n                type: 'NOTIFY',\n                payload: {\n                  error: 'Name can not be left blank.'\n                }\n              }));\n\n            case 4:\n              dispatch({\n                type: 'NOTIFY',\n                payload: {\n                  loading: true\n                }\n              });\n\n              if (!id) {\n                _context.next = 14;\n                break;\n              }\n\n              _context.next = 8;\n              return putData(\"categories/\".concat(id), {\n                name: name\n              }, auth.token);\n\n            case 8:\n              res = _context.sent;\n\n              if (!res.err) {\n                _context.next = 11;\n                break;\n              }\n\n              return _context.abrupt(\"return\", dispatch({\n                type: 'NOTIFY',\n                payload: {\n                  error: res.err\n                }\n              }));\n\n            case 11:\n              dispatch(updateItem(categories, id, res.category, 'ADD_CATEGORIES'));\n              _context.next = 20;\n              break;\n\n            case 14:\n              _context.next = 16;\n              return postData('categories', {\n                name: name\n              }, auth.token);\n\n            case 16:\n              res = _context.sent;\n\n              if (!res.err) {\n                _context.next = 19;\n                break;\n              }\n\n              return _context.abrupt(\"return\", dispatch({\n                type: 'NOTIFY',\n                payload: {\n                  error: res.err\n                }\n              }));\n\n            case 19:\n              dispatch({\n                type: \"ADD_CATEGORIES\",\n                payload: [].concat(_toConsumableArray(categories), [res.newCategory])\n              });\n\n            case 20:\n              setName('');\n              setId('');\n              return _context.abrupt(\"return\", dispatch({\n                type: 'NOTIFY',\n                payload: {\n                  success: res.msg\n                }\n              }));\n\n            case 23:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function createCategory() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleEditCategory = function handleEditCategory(catogory) {\n    setId(catogory._id);\n    setName(catogory.name);\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"col-md-6 mx-auto my-3\",\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Categories\"\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"input-group mb-3\",\n      children: [/*#__PURE__*/_jsx(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        placeholder: \"Add a new category\",\n        value: name,\n        onChange: function onChange(e) {\n          return setName(e.target.value);\n        }\n      }), /*#__PURE__*/_jsx(\"button\", {\n        className: \"btn btn-secondary ml-1\",\n        onClick: createCategory,\n        children: id ? \"Update\" : \"Create\"\n      })]\n    }), categories.map(function (catogory) {\n      return /*#__PURE__*/_jsx(\"div\", {\n        className: \"card my-2 text-capitalize\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"card-body d-flex justify-content-between\",\n          children: [catogory.name, /*#__PURE__*/_jsxs(\"div\", {\n            style: {\n              cursor: 'pointer'\n            },\n            children: [/*#__PURE__*/_jsx(\"i\", {\n              className: \"fas fa-edit mr-2 text-info\",\n              onClick: function onClick() {\n                return handleEditCategory(catogory);\n              }\n            }), /*#__PURE__*/_jsx(\"i\", {\n              className: \"fas fa-trash-alt text-danger\",\n              \"data-toggle\": \"modal\",\n              \"data-target\": \"#exampleModal\",\n              onClick: function onClick() {\n                return dispatch({\n                  type: 'ADD_MODAL',\n                  payload: [{\n                    data: categories,\n                    id: catogory._id,\n                    title: catogory.name,\n                    type: 'ADD_CATEGORIES'\n                  }]\n                });\n              }\n            })]\n          })]\n        })\n      }, catogory._id);\n    })]\n  });\n};\n\nexport default Categories;","map":null,"metadata":{},"sourceType":"module"}