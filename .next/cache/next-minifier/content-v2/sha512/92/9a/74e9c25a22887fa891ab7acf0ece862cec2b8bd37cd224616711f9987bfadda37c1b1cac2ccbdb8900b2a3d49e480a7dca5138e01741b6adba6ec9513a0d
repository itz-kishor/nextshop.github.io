{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[17],{\"0+Tl\":function(e,t,r){\"use strict\";r.d(t,\"a\",(function(){return i}));var a=r(\"o0o1\"),n=r.n(a),s=r(\"HaE+\");function c(e,t){var r;if(\"undefined\"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"===typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e))||t&&e&&\"number\"===typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var s,c=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return c=e.done,e},e:function(e){i=!0,s=e},f:function(){try{c||null==r.return||r.return()}finally{if(i)throw s}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var i=function(){var e=Object(s.a)(n.a.mark((function e(t){var r,a,s,o,i,l,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=c(t),e.prev=2,a.s();case 4:if((s=a.n()).done){e.next=19;break}return o=s.value,(i=new FormData).append(\"file\",o),i.append(\"upload_preset\",\"nextjs_store\"),i.append(\"cloud_name\",\"du71vrd2o\"),e.next=12,fetch(\" https://api.cloudinary.com/v1_1/du71vrd2o/image/upload\",{method:\"POST\",body:i});case 12:return l=e.sent,e.next=15,l.json();case 15:d=e.sent,r.push({public_id:d.public_id,url:d.secure_url});case 17:e.next=4;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(2),a.e(e.t0);case 24:return e.prev=24,a.f(),e.finish(24);case 27:return e.abrupt(\"return\",r);case 28:case\"end\":return e.stop()}}),e,null,[[2,21,24,27]])})));return function(t){return e.apply(this,arguments)}}()},\"W+IF\":function(e,t,r){\"use strict\";r.r(t);var a=r(\"o0o1\"),n=r.n(a),s=r(\"HaE+\"),c=r(\"rePB\"),o=r(\"nKUr\"),i=r(\"8Kt/\"),l=r.n(i),d=r(\"q1tI\"),u=r(\"qG/y\"),p=r(\"YFqc\"),j=r.n(p),b=r(\"cSol\"),f=r(\"EFaQ\"),m=r(\"0+Tl\");function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){Object(c.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.default=function(){var e=Object(d.useState)({avatar:\"\",name:\"\",password:\"\",cf_password:\"\"}),t=e[0],r=e[1],a=t.avatar,i=t.name,p=t.password,O=t.cf_password,x=Object(d.useContext)(u.a),y=x.state,v=x.dispatch,N=y.auth,w=y.notify,g=y.orders;Object(d.useEffect)((function(){N.user&&r(h(h({},t),{},{name:N.user.name}))}),[N.user]);var _=function(e){var a=e.target,n=a.name,s=a.value;r(h(h({},t),{},Object(c.a)({},n,s))),v({type:\"NOTIFY\",payload:{}})},F=function(){v({type:\"NOTIFY\",payload:{loading:!0}}),Object(f.c)(\"user/resetPassword\",{password:p},N.token).then((function(e){return e.err?v({type:\"NOTIFY\",payload:{error:e.err}}):v({type:\"NOTIFY\",payload:{success:e.msg}})}))},T=function(){var e=Object(s.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v({type:\"NOTIFY\",payload:{loading:!0}}),!a){e.next=5;break}return e.next=4,Object(m.a)([a]);case 4:t=e.sent;case 5:Object(f.c)(\"user\",{name:i,avatar:a?t[0].url:N.user.avatar},N.token).then((function(e){return e.err?v({type:\"NOTIFY\",payload:{error:e.err}}):(v({type:\"AUTH\",payload:{token:N.token,user:e.user}}),v({type:\"NOTIFY\",payload:{success:e.msg}}))}));case 6:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return N.user?Object(o.jsxs)(\"div\",{className:\"profile_page\",children:[Object(o.jsx)(l.a,{children:Object(o.jsx)(\"title\",{children:\"Profile\"})}),Object(o.jsxs)(\"section\",{className:\"row text-secondary my-3\",children:[Object(o.jsxs)(\"div\",{className:\"col-md-4\",children:[Object(o.jsx)(\"h3\",{className:\"text-center text-uppercase\",children:\"user\"===N.user.role?\"User Profile\":\"Admin Profile\"}),Object(o.jsxs)(\"div\",{className:\"avatar\",children:[Object(o.jsx)(\"img\",{src:a?URL.createObjectURL(a):N.user.avatar,alt:\"avatar\"}),Object(o.jsxs)(\"span\",{children:[Object(o.jsx)(\"i\",{className:\"fas fa-camera\"}),Object(o.jsx)(\"p\",{children:\"Change\"}),Object(o.jsx)(\"input\",{type:\"file\",name:\"file\",id:\"file_up\",accept:\"image/*\",onChange:function(e){var a=e.target.files[0];return a?a.size>1048576?v({type:\"NOTIFY\",payload:{error:\"The largest image size is 1mb.\"}}):\"image/jpeg\"!==a.type&&\"image/png\"!==a.type?v({type:\"NOTIFY\",payload:{error:\"Image format is incorrect.\"}}):void r(h(h({},t),{},{avatar:a})):v({type:\"NOTIFY\",payload:{error:\"File does not exist.\"}})}})]})]}),Object(o.jsxs)(\"div\",{className:\"form-group\",children:[Object(o.jsx)(\"label\",{htmlFor:\"name\",children:\"Name\"}),Object(o.jsx)(\"input\",{type:\"text\",name:\"name\",value:i,className:\"form-control\",placeholder:\"Your name\",onChange:_})]}),Object(o.jsxs)(\"div\",{className:\"form-group\",children:[Object(o.jsx)(\"label\",{htmlFor:\"email\",children:\"Email\"}),Object(o.jsx)(\"input\",{type:\"text\",name:\"email\",defaultValue:N.user.email,className:\"form-control\",disabled:!0})]}),Object(o.jsxs)(\"div\",{className:\"form-group\",children:[Object(o.jsx)(\"label\",{htmlFor:\"password\",children:\"New Password\"}),Object(o.jsx)(\"input\",{type:\"password\",name:\"password\",value:p,className:\"form-control\",placeholder:\"Your new password\",onChange:_})]}),Object(o.jsxs)(\"div\",{className:\"form-group\",children:[Object(o.jsx)(\"label\",{htmlFor:\"cf_password\",children:\"Confirm New Password\"}),Object(o.jsx)(\"input\",{type:\"password\",name:\"cf_password\",value:O,className:\"form-control\",placeholder:\"Confirm new password\",onChange:_})]}),Object(o.jsx)(\"button\",{className:\"btn btn-info\",disabled:w.loading,onClick:function(e){if(e.preventDefault(),p){var t=Object(b.a)(i,N.user.email,p,O);if(t)return v({type:\"NOTIFY\",payload:{error:t}});F()}(i!==N.user.name||a)&&T()},children:\"Update\"})]}),Object(o.jsx)(\"div\",{children:Object(o.jsx)(j.a,{href:\"orderpage/\",children:Object(o.jsx)(\"a\",{className:\"btn btn-info\",style:{marginRight:\"5px\",flex:1},children:\"View\"})})}),Object(o.jsxs)(\"div\",{className:\"col-md-8\",children:[Object(o.jsx)(\"h3\",{className:\"text-uppercase\",children:\"Orders\"}),Object(o.jsx)(\"div\",{className:\"my-3 table-responsive\",children:Object(o.jsxs)(\"table\",{className:\"table-bordered table-hover w-100 text-uppercase\",style:{minWidth:\"600px\",cursor:\"pointer\"},children:[Object(o.jsx)(\"thead\",{className:\"bg-light font-weight-bold\",children:Object(o.jsxs)(\"tr\",{children:[Object(o.jsx)(\"td\",{className:\"p-2\",children:\"id\"}),Object(o.jsx)(\"td\",{className:\"p-2\",children:\"date\"}),Object(o.jsx)(\"td\",{className:\"p-2\",children:\"total\"}),Object(o.jsx)(\"td\",{className:\"p-2\",children:\"delivered\"}),Object(o.jsx)(\"td\",{className:\"p-2\",children:\"paid\"})]})}),Object(o.jsx)(\"tbody\",{children:g.map((function(e){return Object(o.jsxs)(\"tr\",{children:[Object(o.jsx)(\"td\",{className:\"p-2\",children:Object(o.jsx)(j.a,{href:\"/order/\".concat(e._id),children:Object(o.jsx)(\"a\",{children:e._id})})}),Object(o.jsx)(\"td\",{className:\"p-2\",children:new Date(e.createdAt).toLocaleDateString()}),Object(o.jsxs)(\"td\",{className:\"p-2\",children:[\"\\u20b9\",e.total]}),Object(o.jsx)(\"td\",{className:\"p-2\",children:e.delivered?Object(o.jsx)(\"i\",{className:\"fas fa-check text-success\"}):Object(o.jsx)(\"i\",{className:\"fas fa-times text-danger\"})}),Object(o.jsx)(\"td\",{className:\"p-2\",children:e.paid?Object(o.jsx)(\"i\",{className:\"fas fa-check text-success\"}):Object(o.jsx)(\"i\",{className:\"fas fa-times text-danger\"})})]},e._id)}))})]})})]})]})]}):null}},u1GD:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/profile\",function(){return r(\"W+IF\")}])}},[[\"u1GD\",0,2,1,3,4]]]);","extractedComments":[]}